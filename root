{"version":1,"ops":[{"type":1,"author":{"id":"2dbd4e3eb4885ba122fe44cb65f4e41c3608b66f"},"timestamp":1553455122,"metadata":{"github-id":"MDU6SXNzdWU0MjQ2NDkzOTk=","github-url":"https://github.com/firecat53/keepmenu/issues/30","origin":"github"},"title":"Make dmenu_command work with `sh -c \"dmenu (...)\"` and other non-dmenu commands that end up running dmenu","message":"Hi there! I was looking around for dmenu-based keepass interfaces and found this,\nwhich looks like exactly what I was looking for; but I have an issue with keepmenu.\n\nThe issue for is on how [dmenu_cmd](https://github.com/firecat53/keepmenu/blob/master/keepmenu#L180)\nparses dmenu_command. For some context, I want to set the font size by hostname.\nThe ini configuration file format does not support this, so I thought that\ni'd just set it in dmenu_command. So, I tried something like this:\n\n`dmenu_command = sh -c 'dmenu -fn \"$([ \"$(hostname)\" = \"machine1\" ] \u0026\u0026 {echo font1; exit; }; [ \"$(hostname)\" = \"machine2\" ] \u0026\u0026 {echo font2; exit; }; echo fallback)\"'`\n\nThis works in the command line, but not in dmenu_command.\nI tried this with various quoting patterns, but to no avail. I took a look at\nthe code, and found out that dmenu_cmd blindly assumes that the first part\nof dmenu_command is [dmenu or rofi](https://github.com/firecat53/keepmenu/blob/master/keepmenu#L194).\nThis is rather unintuitive and makes it impossible to do what I wanted.\n\nI therefore suggest that dmenu_cmd see dmenu_command as magic and not parse it,\nand rather only do a substitution with some magic string to insert arguments\nlike ´-l´, allowing the user to place the magic string where appropriate.\nIf you don't want to make this magic string mandatory, then it would be possible\nto assume that it'll work by appending the args to dmenu_command.\n\nI'm aware that it's possible to write a wrapper script to dmenu, but making\na file for something that can be done inline sounds like a script that shouldn't be.","files":null}]}